package models;

import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.*;

import play.db.DB;

public class Artist{
	public int Id;
	public String Firstname;
  public String Lastname;
	public String Alias;
	public Date DateOfBirth;
	public Country Country;
	
	public static ArrayList<Artist> getAll(){	
		
		Connection connection = null;
		ArrayList<Artist> entities = new ArrayList<Artist>();
		
		try {
			connection = DB.getConnection();
			
			Statement statement = connection.createStatement();
			ResultSet rs = statement.executeQuery("SELECT"
					+ " Artist.Id AS ArtistId"
					+ ", Artist.Firstname"
					+ ", Artist.Lastname"
					+ ", Artist.Alias"
	//				+ ", Artist.DateOfBirth"
					+ ", Country.Id AS CountryId"
					+ ", Country.Shortcut"
					+ ", Country.Name"
					+ " FROM Artist"
					+ " INNER JOIN Country ON Artist.CountryId=Country.Id"
					+ " WHERE Artist.State <> 255;");
					
			while(rs.next()){
				Artist entity = new Artist();
				
				entity.Id = rs.getInt("ArtistId");
				entity.Firstname = rs.getString("Firstname");
				entity.Lastname = rs.getString("Lastname");
				entity.Alias = rs.getString("Alias");
	//			entity.DateOfBirth = rs.getDate("DateOfBirth");
				
				Country country = new Country();
				country.Id = rs.getInt("CountryId");
				country.Name = rs.getString("Name");
				country.Shortcut = rs.getString("Shortcut");
				
				entity.Country = country;

				entities.add(entity);
			}
			
			return entities;
			
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
			return entities;
		}
		finally{
			if(connection != null)
				try {
					connection.close();
				} catch (SQLException e1) {
					// TODO Auto-generated catch block
					e1.printStackTrace();
				}
		}
	}
}